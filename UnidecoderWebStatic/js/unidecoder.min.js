var __awaiter=this&&this.__awaiter||function(n,t,i,r){return new(i||(i=Promise))(function(u,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?u(n.value):new i(function(t){t(n.value)}).then(o,s)}e((r=r.apply(n,t||[])).next())})};String.prototype.startsWith||(String.prototype.startsWith=function(n,t){return this.substr(!t||t<0?0:+t,n.length)===n});class CharDef{}class DisplayChar{}class BlockDef{}class BasicInformation{}class Decoder{constructor(){this.functionUrl="https://unidecoderfunctions.azurewebsites.net";this.getBasics=function(){return __awaiter(this,void 0,void 0,function*(){if(!this.basics){console.log("fetching basics");var n;try{n=yield fetch(this.functionUrl+"/api/GetBasicInfo")}catch(t){console.log("error: "+t);n=yield fetch(this.functionUrl+"/api/GetBasicInfo?v="+new Date)}this.basics=yield n.json();console.log("got the basics")}return this.basics})};this.convertChar=function(n,t){return{codepoint:n,hex:t.codepointHex,name:t.name,block:t.block,category:this.basics.categories[t.categoryId],isLatin:t.block.indexOf("Latin")>=0}};this.makeInt=function(n,t){while(n.length&&n[0]==="0")n=n.substr(1);var i=parseInt(n,t);return isNaN(i)?0:i.toString(t).toUpperCase()===n.toUpperCase()?i:0};this.expandToChars=function(n){return __awaiter(this,void 0,void 0,function*(){var t,i;if(console.log("Calling function ListCharacters to parse: "+n),!n)return[];yield this.getBasics();try{t=yield fetch(this.functionUrl+"/api/ListCharacters?text="+encodeURIComponent(n))}catch(r){return console.log("error: "+r),null}return i=yield t.json(),i.map(n=>this.convertChar(n.codepoint,n))})};this.findChars=function(n){return __awaiter(this,void 0,void 0,function*(){var t,i,r;if(console.log("Calling function FindCharacters to search for: "+n),!n)return[];yield this.getBasics();try{t=yield fetch(this.functionUrl+"/api/FindCharacters?search="+encodeURIComponent(n))}catch(u){return console.log("error: "+u),null}return i=yield t.json(),r=i.map(n=>this.convertChar(n.codepoint,n)),r})};this.getBlockList=function(){return __awaiter(this,void 0,void 0,function*(){var i,t,n;for(yield this.getBasics(),i=this.basics.blocks,t=[],n=0;n<i.length;n++)t.push({index:n,name:i[n]});return t.sort(function(n,t){return n.name===t.name?0:n.name.indexOf("Latin")>=0?t.name.indexOf("Latin")>=0?n.name<t.name?-1:1:-1:t.name.indexOf("Latin")>=0?1:n.name<t.name?-1:1}),t})};this.findCharsByBlock=function(){return __awaiter(this,void 0,void 0,function*(){yield this.getBasics();return[]})};this.getCharCount=function(){return __awaiter(this,void 0,void 0,function*(){var n=yield this.getBasics();return n.charCount})}}}(function(n){"use strict";var t=new Decoder;n.decoder=t})(window);